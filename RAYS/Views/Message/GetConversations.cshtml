@model IEnumerable<dynamic>

@{
    ViewData["Title"] = "Conversations";
}

<div class="flex bg-gray-100 min-h-screen">
    <!-- Main content container -->
    <div class="w-full max-w-7xl mx-auto bg-white shadow-lg rounded-lg p-8 flex flex-col">
        <!-- Header -->
        <h1 class="text-3xl font-extrabold text-gray-900 mb-6">Conversations</h1>

        <!-- Conversation list -->
        <div class="flex-grow space-y-4 overflow-y-auto">
            @if (Model != null && Model.Any())
            {
                @foreach (var conversation in Model)
                {
                    <div 
                        class="p-4 bg-emerald-100 hover:bg-emerald-200 rounded-lg cursor-pointer flex justify-between items-center"
                        onclick="window.location.href='@Url.Action("GetMessages", new { senderId = conversation.CorrespondentId, receiverId = User.FindFirst("UserId")?.Value })'">
                        
                        <!-- Left section: Correspondent username and last message -->
                        <div class="flex flex-col">
                            <p class="text-lg font-semibold text-gray-800">
                                User @conversation.CorrespondentId
                            </p>
                            <p class="text-sm text-gray-600">
                                @(conversation.IsResponded ? "Sent:" : "Received:") @conversation.Content
                            </p>
                            <p class="text-xs text-gray-500">
                                @conversation.Timestamp.ToString("MMMM d, yyyy h:mm:ss tt")
                            </p>
                        </div>

                        <!-- New message indicator -->
                        @if (!conversation.IsResponded)
                        {
                            <div class="bg-blue-500 w-3 h-3 rounded-full"></div>
                        }
                    </div>
                }
            }
            else
            {
                <p class="text-center text-gray-500">No conversations found.</p>
            }
        </div>
    </div>
</div>

